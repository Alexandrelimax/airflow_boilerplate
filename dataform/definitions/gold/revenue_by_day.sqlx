config {
  type: "table",
  schema: constants.goldSchema,
  tags: ["gold", "metrics", "revenue"]
}

SELECT
  DATE(order_date) AS order_day,
  COUNT(DISTINCT order_id) AS total_orders,
  COUNT(DISTINCT user_id) AS distinct_customers,
  SUM(quantity) AS total_items_sold,
  SUM(quantity * item_price) AS total_revenue
FROM ${ref("orders_cleaned")}
GROUP BY order_day
ORDER BY order_day
